<div><script type="@plotdb/block">module.exports={pkg:{i18n:{en:{title:"Change Password",old:"Old Password",nomatch:"Password not matched.",forget:"Forget Password?",send:"Get Reset Link",new:"New Password",weak:"Password too weak",again:"New Password Again",update:"Update Password",str:"Password Strength",len:"Length",bad:"Bad",ok:"Okay",good:"Good",fail:"Incorrect Old Password?",done:"Update Password Successfully",sent:"Link Sent",hint:["A good password should be at least 10 characters long. Please do not use your name, phone number, or birthday as your password.",["You can check out the article","to learn what makes a good password."]]},"zh-TW":{title:"變更密碼",old:"舊的密碼",nomatch:"密碼不符",forget:"忘記密碼嗎？",send:"寄發重設連結信",new:"新密碼",weak:"密碼太弱了",again:"再輸入一次新密碼",update:"更新密碼",str:"密碼強度",len:"長度",bad:"不妙",ok:"還好",good:"不錯",fail:"舊的密碼有誤",done:"密碼更新完成",sent:"連結已寄出",hint:["好的密碼至少要夠長 ( 至少十個字 )。請不要用姓名、電話或生日當您的密碼。",["你可以查閱","這篇文章來了解怎樣算是一個好密碼。"]]}},dependencies:[{name:"ldform"}]},init:function(e){var d,n,u;d=e.root,n=e.ctx,u=e.t;return servebase.corectx(function(e){var o;o=e.core;return o.init().then(function(){var s,r,t;s=o.auth,r=o.captcha;t=n.ldform;return s.ensure().then(function(e){var n,a;n=new ldview({root:d,init:{"update-password":function(e){var n,t;n=e.node,t=e.local;return t.ldld=new ldloader({root:n})},"send-reset-link":function(e){var n,t;n=e.node,t=e.local;return t.ldld=new ldloader({root:n})}},action:{click:{"send-reset-link":function(e){var n,t,a;n=e.node,t=e.local;if(n.classList.contains("disabled")){return}a=t.ldld;a.on();return r.guard({cb:function(e){var n;n={email:o.user.username,captcha:e};return ld$.fetch("/api/auth/passwd/reset",{method:"POST"},{json:n})}})["finally"](function(){return debounce(1e3).then(function(){return a.off()})}).then(function(){n.innerHTML=u("sent")+' <i class="i-check"></i>';n.classList.add("disabled");return ldnotify.send("success",u("sent"))})},"update-password":function(e){var n,t;n=e.local,t=e.node;if(t.classList.contains("disabled")){return}return a.checkAll().then(function(){var e,t;if(!a.ready()){return}e=n.ldld;e.on();t=a.values();return r.guard({cb:function(e){var n;n={o:t.oldpasswd,n:t.newpasswd1,captcha:e};return ld$.fetch("/api/auth/passwd/",{method:"put",headers:{"Content-Type":"application/json; charset=UTF-8"}},{json:n})}})["finally"](function(){return e.off()}).then(function(){return s.fetch({renew:true})}).then(function(){ldnotify.send("success",u("done"));return a.reset()})["catch"](function(e){var n;n=lderror.id(e);return ldnotify.send("danger",n===1031?u("weak"):n===1030?u("nomatch"):u("fail"))})})}}}});return a=new t({root:d,afterCheck:function(e){var n,t,a,s,r,o,d,i,l,c;n=[this.fields.newpasswd1.value,this.fields.newpasswd2.value],t=n[0],a=n[1];e.username=0;if(e.newpasswd1!==1&&t.length<6){e.newpasswd1=2;e.newpasswd2=1}if(t!==a&&(e.newpasswd2!==1||a&&e.newpasswd1===0)){e.newpasswd2=2}s=ld$.find(this.root,"[data-node]",0);if(e.newpasswd1!==1){r=Math.round(t.length);o=r<8?"bad":r<10?"ok":"good";d=100*(r<12?r:12)/12;i=r<8?"danger":r<10?"warning":"success";ld$.find(s,"label",0).textContent=u("len")+": "+u(o);l=ld$.find(s,".progress-bar",0);l.style.width=d+"%";c=l.getAttribute("class");c=c.replace(/bg-\S+/,"").trim()+(" bg-"+i);return l.setAttribute("class",c)}}})})})})}};</script><style type="text/css">._sudo-row{display:flex;margin:0 -15px}._sudo-row ._sudo-col:first-child{width:66.66667%;padding:0 15px}._sudo-row ._sudo-col:last-child{width:33.33333%;padding:0 15px}@media(max-width:768px){._sudo-row ._sudo-col:first-child,._sudo-row ._sudo-col:last-child{width:50%}}</style><h3 t>title</h3><hr><form class="form" data-name="passwd"><div class="_sudo-row"><div class="_sudo-col"><div class="form-group"><label t>old</label><input class="d-none" name="username" type="text" autocomplete="username"><input class="form-control" name="oldpasswd" type="password" autocomplete="current-password"><div class="invalid-feedback" t>nomatch</div></div></div><div class="_sudo-col"><div class="form-group"><label t>forget</label><div class="btn btn-outline-dark btn-block ld-ext-right" ld="send-reset-link"><i class="i-mail d-none d-sm-inline" aria-hidden="true"></i><span class="mx-1 text-nowrap" t>send</span><div class="ld ldld bare em-1"></div></div></div></div></div><div class="row"><div class="col-md-8"><div class="form-group"><label t>new</label><input class="form-control" name="newpasswd1" type="password" autocomplete="new-password"><div class="invalid-feedback" t>weak</div></div></div><div class="col-md-4"><div class="form-group pt-2" data-node="passwd-bar1"><label class="text-sm text-muted text-capitalize mb-1" t="str"></label><div class="progress" style="height:36px"><div class="progress-bar progress-bar-striped" style="width:0%"></div></div></div></div></div><div class="row"><div class="col-md-8"><div class="form-group"><label t>again</label><input class="form-control" name="newpasswd2" type="password" autocomplete="new-password"><div class="invalid-feedback" t>nomatch</div></div><div class="btn btn-primary btn-block mb-4 ld-ext-right" ld="update-password"><span class="mr-1" t>update</span><div class="ld ldld bare em-1"></div></div><div class="text-muted"><small><p t>hint.0</p><p><span t>hint.1.0</span> <a href="https://en.wikipedia.org/wiki/Password_strength" target="_blank" rel="noopener noreferrer">Password Strength</a> <span t>hint.1.1</span></p></small></div></div><div class="col-md-4">&nbsp;</div></div></form></div>
