<div><div plug="layout"><div class="pdl-layout"><div data-type="layout"><div class="pdl-cell" data-name="number"></div><div class="pdl-cell" data-name="unit"></div></div><div data-type="render"></div></div></div><style type="text/css">.pdl-layout>[data-type=layout]{flex-direction:column;display:flex;align-items:center;justify-content:center}.pdl-layout>[data-type=layout] .pdl-cell{line-height:1em;white-space:nowrap}.pdl-layout>[data-type=layout] .pdl-cell[data-name=number]{font-weight:bold}</style><script type="@plotdb/block">var mod;module.exports={pkg:{name:"number",version:"0.0.1",extend:{name:"base",version:"0.0.1"},dependencies:[]},init:function(t){var n,e,i;n=t.root,e=t.context,i=t.pubsub;return i.fire("init",{mod:mod({context:e})}).then(function(t){return t[0]})}};mod=function(t){var n,e,i,r,u;n=t.context;e=n.d3,i=n.ldcolor,r=n.repeatString$,u=n.infinite;return{sample:function(){return{raw:[{val:12777216,name:"票房",unit:"新臺幣"}],binding:{name:{key:"name"},value:{key:"val",unit:"百萬元新臺幣"}}}},config:{enlarge:{type:"boolean",default:false}},dimension:{value:{type:"R",name:"value"},name:{type:"N",name:"name"},unit:{type:"N",name:"unit"}},init:function(){var n=this;this.n=Object.fromEntries(["number","unit"].map(function(t){return[t,n.layout.getNode(t)]}));this.g=Object.fromEntries(["number","unit"].map(function(t){return[t,e.select(n.layout.getGroup(t))]}));this.g.number.append("text");this.g.unit.append("text");return this.v={number:0,unit:"",run:0}},resize:function(){var t,n,e,i,r,u,a=this;t=[this.box.width,this.box.height],n=t[0],e=t[1];this.sizeRate={number:this.cfg.numberSizeRate||3,unit:this.cfg.unitSizeRate||1};import$(this.v,{number:(this.data[0]||{value:0}).value,unit:this.binding.value.unit||(this.data[0]||{unit:""}).unit||""});i=this.n.number;i.style.fontSize=this.sizeRate.number+"em";i.textContent=this.v.number;r=this.n.unit;r.style.fontSize="1em";r.textContent=this.v.unit;this.r=u=Object.fromEntries(["number","unit"].map(function(t){return[t,n/(a.n[t].getBoundingClientRect().width||1)]}));(!this.cfg.enlarge?["number","unit"]:["unit"]).map(function(t){var n;return a.r[t]=(n=u[t])<1?n:1});this.n.number.style.fontSize=this.sizeRate.number*u.number+"em";this.n.unit.style.fontSize=this.sizeRate.unit*u.unit+"em";return this.layout.update(false)},tick:function(){var t=this;return this.g.number.select("text").text(function(){t.v.run=(t.v.number-t.v.run)*.1+t.v.run;if(t.v.run===t.v.number){t.stop()}return Math.round(t.v.run)})},render:function(){this.g.number.select("text").attr("x",this.n.number.getBoundingClientRect().width/2).attr("font-size",this.sizeRate.number*this.r.number+"em").attr("font-weight","bold").attr("dominant-baseline","hanging").attr("text-anchor","middle").text(Math.round(this.v.run));this.g.unit.select("text").attr("font-size",this.sizeRate.unit*this.r.unit+"em").attr("dominant-baseline","hanging").text(this.v.unit);return this.start()}}};function import$(t,n){var e={}.hasOwnProperty;for(var i in n)if(e.call(n,i))t[i]=n[i];return t}</script></div>