<div><script type="@plotdb/block">var mod;module.exports={pkg:{name:"wordcloud",version:"0.0.1",extend:{name:"base",version:"0.0.1"},dependencies:[{url:"https://unpkg.com/d3-cloud@1.2.5/build/d3.layout.cloud.js"},{name:"@xlfont/load",version:"main"}]},init:function(t){var e,n,a;e=t.root,n=t.ctx,a=t.pubsub;return a.fire("init",{mod:mod({ctx:n}),layout:false}).then(function(t){return t[0]})}};mod=function(t){var e,n,i,a,o,r,s;e=t.ctx,n=t.root;i=e.d3,a=e.forceBoundary,o=e.ldcolor,r=e.chart,s=e.xfl;return{sample:function(){return{raw:["cover","scandal","seem","consumption","garbage","hunter","pepper","west","guilt","conspiracy","pupil","boat","muscle","nightmare","gene","royalty","salon","difficult","management","brainstorm","aid","moving","plaster","cake","issue","realism","subject","speed","railcar","break","grass","collapse","is","leave","retiree","looting","transaction","copyright","serve","guard","colony","spell","ask","ranch","cell","sensation","name","default","reflection"].map(function(t,e){return{text:t,value:1.5*e+10}}),binding:{value:{key:"value"},text:{key:"text"}}}},config:{palette:{type:"palette"},color:{random:{type:"boolean",default:false}},background:{type:"color"},font:{size:{type:"number",min:1,max:256,step:1,default:64},family:{type:"font"}},cloud:{rotate:{angle:{type:"number",default:0,min:0,max:360,step:.1},variant:{type:"number",default:0,min:0,max:180,step:.1}}}},dimension:{value:{type:"R",name:"size"},text:{type:"NCO",name:"name"}},init:function(){var t,n=this;this.tint=t=new r.utils.tint;this.cloud=i.layout.cloud();this.cloud.canvas(function(){var t,e;t=document.createElement("canvas");e=t.getContext("2d",{willReadFrequently:true});return t}).rotate(function(){var t,e;t=n.cfg.cloud.rotate.angle||0;e=n.cfg.cloud.rotate.variant||0;return t+e*(Math.random()*2-1)}).padding(2).fontSize(function(t){return n.cfg.font.size*t.value}).on("end",function(){return n.render()});return this.fonts={h:{},active:null,name:function(){return(n.fonts.active||{}).name||(n.cfg.font.family||{}).name||"arial"}}},parse:function(){var t,e=this;this.parsed=this.data.map(function(t){var e;e=import$({},t);e._value=e.value;e.value=Math.sqrt(e._value);return e});this._max=Math.max.apply(Math,this.parsed.map(function(t){return t.value}));this.parsed.map(function(t){return t.value=t.value/e._max});if(this.cfg.font.family){console.log(this.cfg.font.family.isXl)}if(this.cfg.font.family&&this.cfg.font.family.isXl){if(!(t=this.fonts.h[this.cfg.font.family.path])){this.fonts.h[this.cfg.font.family.path]={loading:true};s.load(this.cfg.font.family.path).then(function(t){e.fonts.h[e.cfg.font.family.path]=e.fonts.active=t;if(!t.sync){return}return t.sync(e.parsed.map(function(t){return t.text}).join("")).then(function(){e.resize();return e.render()})})}if(t&&t.sync){return t.sync(this.parsed.map(function(t){return t.text}).join("")).then(function(){e.resize();return e.render()})}}},resize:function(){this.cloud.size([this.box.width,this.box.height].map(function(t){return Math.round(t)})).words(this.parsed).font(this.fonts.name()).start();return this.tint.set(this.cfg.palette.colors)},render:function(){var e,t,n,a,r=this;e=i.interpolateTurbo;if(this.cfg!=null&&this.cfg.palette){e=i.interpolateDiscrete(this.cfg.palette.colors.map(function(t){return o.web(t.value||t)}))}t=i.extent(this.parsed.map(function(t){return t.value}));n=i.scaleLinear().domain(t).range([0,1]);a=i.select(this.svg).selectAll("text").data(this.parsed);a.exit().remove();a.enter().append("text");return i.select(this.svg).selectAll("text").attr("transform",function(t){return"translate("+(t.x+r.box.width/2)+" "+(t.y+r.box.height/2)+") rotate("+t.rotate+")"}).attr("text-anchor","middle").attr("font-size",function(t){return t.size}).attr("font-family",this.fonts.name()).attr("fill",function(t){if(r.cfg.color.random){return r.tint.get(t.text)}else{return e(n(t.value))}}).text(function(t){return t.text})},tick:function(){}}};function import$(t,e){var n={}.hasOwnProperty;for(var a in e)if(n.call(e,a))t[a]=e[a];return t}</script></div>