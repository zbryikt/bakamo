<div><div plug="layout"><div class="pdl-layout"><div data-type="layout"><div class="pdl-cell" data-name="view"></div><div class="pdl-cell" data-name="axis">&nbsp;</div><div class="pdl-cell" data-name="legend">&nbsp;</div></div><div data-type="render"></div></div></div><style type="text/css">g[data-name=axis]{font-size:11px}.pdl-layout>div[data-type=layout]{display:grid;grid-template-columns:1fr fit-content(10em);grid-template-rows:1fr fit-content(1em)}.pdl-layout>div[data-type=layout]>.pdl-cell[data-name=legend]{grid-column:2;grid-row:1/span 2;padding-left:1em}</style><script type="@plotdb/block">var mod;module.exports={pkg:{name:"bar-race",version:"0.0.1",extend:{name:"base",version:"0.0.1"},dependencies:[],i18n:{"zh-TW":{height:"高度"}}},init:function(t){var e,n,a,i;e=t.root,n=t.context,a=t.t,i=t.pubsub;return i.fire("init",{mod:mod({context:n,t:a})})}};mod=function(t){var e,n,a,r,i;e=t.context,n=t.t;a=e.chart,r=e.d3,i=e.debounce;return{sample:function(){return{raw:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100].map(function(t){var e,n,a,i;e=[t%10,Math.floor(t/10)],n=e[0],a=e[1];i={name:n,value:Math.random(),order:a};return i}),binding:{order:{key:"order"},value:{key:"value"},name:{key:"name"}}}},config:{},dimension:{order:{type:"O",name:"order",priority:1},value:{type:"R",name:"value",priority:2},name:{type:"N",name:"name"}},init:function(){var e,t;this.tint=e=new a.utils.tint;this.g={view:r.select(this.layout.getGroup("view")),axis:r.select(this.layout.getGroup("axis"))};this.scale=t={};this.axisBottom=r.axisBottom();return this.legend=new a.utils.legend({layout:this.layout,name:"legend",root:this.root,shape:function(t){return r.select(this).attr("fill",e.get(t.key))}})},parse:function(){this.data.map(function(t){return t.value=t.value.map(function(t){if(isNaN(t)){return 0}else{return+t}})});return this.names=Array.from(new Set(this.data.map(function(t){return t.name})))},resize:function(){var t,a,e,n,i=this;this.layout.getNode("legend").style.width=!(((t=this.cfg).legend||(t.legend={})).enabled!=null)||this.cfg.legend.enabled?"":"0";this.layout.update(false);this.maxPerGroup=this.binding.height.map(function(t,e){return Math.max.apply(Math,i.data.map(function(t){return t.height[e]}))});this.order=this.data.map(function(t,e){return{key:t._idx,idx:e,name:t.order}});this.order.sort(function(t,e){if(e.name>t.name){return 1}else if(e.name<t.name){return-1}else{return 0}});this.tint.set(this.cfg.palette);this.legend.data(function(){var t,e,n=[];for(t=0,e=this.names.length;t<e;++t){a=t;n.push({key:a,text:this.names[a]})}return n}.call(this));this.layout.update(false);e=Math.max(this.data.map(function(t){return t.value}));n=this.layout.getBox("view");return t=this.scale,t.y=r.scaleLinear().domain([0,e]).range([n.width,0]),t.x=r.scaleBand().domain(this.order.map(function(t){return t.name||t.key})).range([0,n.height]),t},render:function(){var t,n,e,a,i,r,s,o;t=this.binding,n=this.scale,e=this.range,a=this.delta,i=this.cfg,r=this.tint,s=this.data;o=this.g.view.selectAll("g.bar").data(this.data);o.exit().remove();o.enter().append("g").attr("class","bar");this.g.view.selectAll("g.bar").attr("transform",function(t,e){return"translate("+n.x(t.name)+",0)"});return this.g.axis.call(this.axisBottom).attr("font-size","")},tick:function(){}}};</script></div>