<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>BAKAMO</title><link rel="stylesheet" type="text/css" href="/assets/lib/bootstrap/main/dist/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/@loadingio/bootstrap.ext/main/index.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/lddatetimepicker/main/index.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/ldiconfont/main/index.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/ldcover/main/index.min.css"><link rel="stylesheet" type="text/css" href="/css/index.min.css"><style type="text/css">.book{display:flex;gap:.5em;align-items:center;justify-content:start;padding-bottom:.5em;margin-bottom:.5em;border-bottom:1px solid #eeeff0}.book>div:nth-child(1){width:10em;flex:0 0 auto}.book>div:nth-child(2){width:10em;flex:0 0 auto}.book>div:nth-child(3){width:10em;flex:0 0 auto}@media(max-width:960px){.book{flex-wrap:wrap}.book>div:nth-child(1){width:100%}.book>div:nth-child(2){width:40%;flex:0 0 auto}.book>div:nth-child(3){width:40%;flex:0 0 auto}}</style></head><body><div ld-scope="navtop"><div class="navbar navbar-expand-lg navbar-light fixed-top" ld="root"><div class="collapse navbar-collapse"><a class="d-flex align-items-center" href="/" style="font-size:24px;line-height:1em"><div class="font-weight-bold text-sm text-dark">BAKAMO</div></a><div class="ml-auto"><ul class="navbar-nav ml-4"><li class="nav-item d-none" ld="unauthed login"><a class="nav-link">登入</a></li><li class="nav-item d-none" ld="unauthed signup"><a class="nav-link">註冊</a></li><li class="nav-item dropdown d-none" ld="authed profile"><a class="nav-link dropdown-toggle" href="#" data-toggle="dropdown"><i class="i-user"></i></a><div class="dropdown-menu dropdown-menu-right shadow-sm"><a class="dropdown-item" href="/me/settings/"><div class="align-middle text-capitalize text-ellipsis" ld="displayname">Greeting!</div><div class="text-sm align-middle text-ellipsis" ld="username">...</div></a><div class="dropdown-divider"></div><a class="dropdown-item" href="/me/settings/">設定</a><div class="dropdown-divider"></div><div class="dropdown-item text-danger" ld="logout">登出</div></div></li></ul></div></div></div></div><div class="w-1024 rwd mx-auto"><div class="mb-5"><div class="d-flex align-items-end g-1"><h2 class="mb-0">書單列表</h2><div class="flex-grow-1"></div><div class="btn btn-sm btn-outline-primary" ld="new-sudan">新增書單</div></div><hr><div><div class="sudan d-flex g-2" ld-each="sudan"><div ld="title"></div><div class="text-truncate" ld="description"></div><div ld="createdtime"></div></div></div></div><div class="d-flex align-items-end g-1"><h2 class="mb-0">我的書單</h2><div class="flex-grow-1"></div><div class="btn-group mr-1"><div class="btn btn-sm btn-outline-primary" ld="scan">掃書</div><div class="btn btn-sm btn-outline-primary" ld="new-dusu">手動</div></div><div class="btn btn-sm btn-outline-primary" ld="new-book">追加書籍</div></div><hr><div class="mb-5"><div class="book head border-bottom pb-2 mb-2"><div>書名</div><div>開讀日</div><div>完讀日</div></div><div class="d-none" ld="dusu-loading">載入中</div><div class="d-none" ld="no-dusu">沒有書</div><div class="book" ld-each="dusu"><div><div ld="title"></div><div class="text-sm text-muted" ld="isbn"></div></div><div><div ld="startdate"></div></div><div><div ld="enddate"></div></div></div></div></div><script type="text/javascript" src="/assets/lib/i18next/main/dist/umd/i18next.min.js" defer></script><script type="text/javascript" src="/assets/lib/i18next-browser-languagedetector/main/dist/umd/i18nextBrowserLanguageDetector.min.js" defer></script><script type="text/javascript" src="/assets/lib/bootstrap.native/main/dist/bootstrap-native-v4.min.js" defer></script><script type="text/javascript" src="/assets/lib/proxise/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@loadingio/debounce.js/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@loadingio/ldquery/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@loadingio/ldc/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/dayjs/main/dayjs.min.js" defer></script><script type="text/javascript" src="/assets/lib/zmgr/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/ldview/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/ldcover/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/ldnotify/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/ldcvmgr/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/lderror/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/ldloader/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/lddatetimepicker/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/httputil/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/semver/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/rescope/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/csscope/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/block/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@servebase/auth/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@servebase/consent/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@servebase/captcha/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@servebase/erratum/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@servebase/core/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@servebase/connector/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@servebase/navtop/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@undecaf/zbar-wasm/main/dist/index.js" defer></script><script type="text/javascript" src="/assets/lib/@undecaf/barcode-detector-polyfill/main/dist/index.js" defer></script><script type="text/javascript" src="/js/site.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/chart/main/index.min.js" defer></script><script type="module">(function(n){return n.apply({})})(function(){return servebase.corectx(function(n){var r;r=n.core;return r.init().then(function(){return r.auth.ensure().then(function(){var e,u;e={_:{all:[],loading:true,cur:null,detail:{}},get:function(){if(this._.loading){return[]}else{return this._.all||[]}},cur:function(){return this._.cur},isLoading:function(){return!!this._.loading},update:function(){return this.fetch().then(function(){return u.render()})},toggle:function(t){var n=this;t==null&&(t={});t=this._.all.filter(function(n){return n.key===(t.key||t)})[0];this._.cur=t;this._.loading=true;u.render();return this.fetchSudan()["finally"](function(){return n._.loading=false}).then(function(){return u.render()})},fetchSudan:function(){var t,e=this;if(!this._.cur){return}t=this._.cur.key;console.log(t,this._.cur);return ld$.fetch("/api/sudan/"+t,{method:"GET"},{type:"json"}).then(function(n){return e._.detail[t]=n.map(function(n){var t;return t=n.dusu,t.book=n.book,t})})},fetch:function(){var t=this;this._.loading=true;return debounce(350).then(function(){return ld$.fetch("/api/user/"+r.user.key+"/sudan",{method:"GET"},{type:"json"})}).then(function(n){t._.all=n;if(!t._.cur){t._.cur=n[0]}return t.fetchSudan()})["finally"](function(){return t._.loading=false})},dusu:{get:function(){return e._.detail[(e.cur()||{}).key]||[]},add:function(n){r.loader.on();return ld$.fetch("/api/sudan/"+e.cur().key,{method:"POST"},{json:n})["finally"](function(){return r.loader.off()}).then(function(){return e.update()})}}};u=new ldview({root:document.body,initRender:false,action:{click:{scan:function(){return r.ldcvmgr.get({ns:"local",name:"scanner"},{data:e.cur()}).then(function(n){var t;n==null&&(n={});if(!n.key){return}t={list:[{book:n.key,enddate:new Date}]};return e.dusu.add(t)})},"new-sudan":function(){return r.ldcvmgr.get({ns:"local",name:"new-sudan"},{data:e.cur()}).then(function(){})},"new-dusu":function(){return r.ldcvmgr.get({ns:"local",name:"new-dusu"},{data:e.cur()}).then(function(){return e.update()})},"new-book":function(){return r.ldcvmgr.get({ns:"local",name:"new-book"})}}},handler:{"sudan-loading":function(n){var t;t=n.node;return t.classList.toggle("d-none",!e.isLoading())},"no-dusu":function(n){var t;t=n.node;return t.classList.toggle("d-none",e.isLoading()||e.dusu.get().length)},sudan:{list:function(){return e.get()},key:function(n){return n.key},view:{action:{click:{"@":function(n){var t;t=n.ctx;return e.toggle(t)}}},text:{title:function(n){var t,e;t=n.node,e=n.ctx;return e.title||"未命名"},description:function(n){var t,e;t=n.node,e=n.ctx;return e.description||""},createdtime:function(n){var t,e;t=n.node,e=n.ctx;if(!e.createdtime){return"n/a"}else{return dayjs(e.createdtime).format("YYYY/MM/DD hh:mm:ss")}}}}},dusu:{list:function(){return e.dusu.get()},key:function(n){return n.key},view:{init:{startdate:function(n){var t,e,r;t=n.node,e=n.ctx;r=new lddatetimepicker({host:t});return r.on("change",function(n){console.log(n);e.startdate=n;return u.render()})}},action:{click:{startdate:function(){}}},text:{title:function(n){var t,e;t=n.node,e=n.ctx;return e.book.title},isbn:function(n){var t,e;t=n.node,e=n.ctx;return e.book.isbn},startdate:function(n){var t,e;t=n.node,e=n.ctx;if(!e.startdate){return"n/a"}else{return dayjs(e.startdate).format("YYYY/MM/DD hh:mm:ss")}},enddate:function(n){var t,e;t=n.node,e=n.ctx;if(!e.enddate){return"n/a"}else{return dayjs(e.enddate).format("YYYY/MM/DD hh:mm:ss")}}}}}}});return Promise.resolve().then(function(){return u.render()}).then(function(){return e.fetch()}).then(function(){return u.render()})})})})});</script></body></html>